/*
 *  Yellow Text - v0.5.0
 *  Yellow Text is a beautiful text editor which makes creating content fun again. It ships with a beautiful theme and really clever shortkeys.
 *  https://github.com/stefanvermaas/yellow-text
 *
 *  Made by Stefan Vermaas
 *  Under BEERWARE License
 */
!function(a){function b(){}function c(b,c){this.element=b,this.options=a.extend({},e,c),this._defaults=e,this._name=d,this.initialize()}var d="YellowText",e={width:"100%",height:"300px",containerClass:"js-editor-container",buttonsClass:"js-editor-buttons",iFrameClass:"js-editor-iframe",cleanOnSubmit:!0,defaultFont:"Helvetica Neue, Helvetica, arial, sans-serief",defaultFontSize:"1em",defaultFontColor:"#000000",defaultActions:["bold","underline","italic","strikethrough","align-left","align-center","align-right","unordered-list","ordered-list","link","image"],isContentChanged:b};c.prototype={initialize:function(){this.render(),this.setContentToEditor(this.getContentFromTextarea()),this.events()},setContentToEditor:function(b){return a(this.editor).contents().find("body").append(b),b},setContentToTextarea:function(b){return a(this.element).val(b),b},getContentFromTextarea:function(){return a(this.element).val()},getContentFromEditor:function(){return a(this.editor).contents().find("body").html()},render:function(){a(this.element).hide(),this.container=a("<div />").addClass(this.options.containerClass).css({"float":"left",width:this.options.width,border:"1px solid #ccc"}),a(this.element).after(this.container),this.editor=a("<iframe />").addClass(this.options.iFrameClass).css({"float":"left",width:this.options.width,height:this.options.height,border:0,overflow:"hidden"}).appendTo(this.container).get(0),this.editor.contentWindow.document.open(),this.editor.contentWindow.document.close(),this.editor.contentWindow.document.designMode="on",a(this.editor).contents().find("body").css({"word-wrap":"break-word","font-family":this.options.defaultFont,"font-size":this.options.defaultFontSize,color:this.options.defaultFontColor});var b='<style type="text/css">body{padding:2%;}p{margin:0;}</style>';a(this.editor).contents().find("head").append(b),this.buttons=a("<div />").addClass(this.options.buttonsClass).css({"float":"left",width:this.options.width}).prependTo(this.container),this.createButtons()},createButtons:function(){for(var b=0;b<this.options.defaultActions.length;b++){var c;switch(this.options.defaultActions[b]){case"bold":c={content:"b",command:"bold"};break;case"underline":c={content:"u",command:"underline"};break;case"italic":c={content:"i",command:"italic"};break;case"strikethrough":c={content:"s",command:"strikethrough"};break;case"align-left":c={content:"left",command:"JustifyLeft"};break;case"align-center":c={content:"center",command:"JustifyCenter"};break;case"align-right":c={content:"right",command:"JustifyRight"};break;case"unordered-list":c={content:"ul",command:"InsertUnorderedList"};break;case"ordered-list":c={content:"ol",command:"InsertOrderedList"};break;case"image":c={content:"img",command:"image"};break;case"link":c={content:"link",command:"link"};break;default:c={content:"",command:""}}a("<a />").addClass(c.command).text(c.content).data("command",c.command).appendTo(this.buttons)}},events:function(){var b=this;a("."+this.options.buttonsClass+" a").on("click",function(c){var d=a(this).data("command");b.buttonClicked(c,d)}),a(this.editor).contents().find("body").on("keydown",function(a){(a.ctrlKey||a.metaKey)&&b.shortkey(a,this)}),a(this.editor).contents().find("body").on("keyup",function(){var c=a(b.editor).contents().find("body").html()!==a(b.element).text()?!0:!1;b.options.isContentChanged(c)}),a(this.element).parents("form").on("submit",function(){b.cleanTheCode(),b.setContentToTextarea(b.getContentFromEditor())})},buttonClicked:function(a,b){this.editor.contentWindow.focus(),this.runCMD(b),this.editor.contentWindow.focus()},shortkey:function(a){var b=a.which;if(66===b||73===b||85===b){switch(this.editor.contentWindow.focus(),b){case 66:this.runCMD("bold");break;case 73:this.runCMD("italic");break;case 85:this.runCMD("underline")}this.editor.contentWindow.focus()}},runCMD:function(a){if("image"===a){var b;"function"==typeof this.options.setImage&&(b=this.options.setImage.call());var c="undefined"!=typeof b&&b.length>0?b:prompt("URL (example: http://www.google.com): ");return this.editor.contentWindow.document.execCommand("InsertImage",!1,c)}if("link"===a){var d=prompt("URL (example: http://www.google.com): ");return this.editor.contentWindow.document.execCommand("CreateLink",!1,d)}return this.editor.contentWindow.document.execCommand(a)},cleanTheCode:function(){a(this.editor).contents().find("body").find("br").removeAttr("class").unwrap(),a(this.editor).contents().find("body").find("ul").removeAttr("class").unwrap(),a(this.editor).contents().find("body").find("ol").removeAttr("class").unwrap(),a(this.editor).contents().find("div").wrap("<p />").contents().unwrap()}},a.fn[d]=function(b){return this.each(function(){a.data(this,"plugin_"+d)||a.data(this,"plugin_"+d,new c(this,b))})}}(jQuery,window,document);